
-- Вывести всех клиентов из страны Canada
SELECT *
FROM customer
where country = 'Canada';
-- Вывести все страны клиентов
SELECT  DISTINCT country
FROM customer;
-- Вывести количество всех заказов
SELECT count(*)
FROM orders;
-- Вывести максимальную стоимость заказа
SELECT max(total_amount)
FROM orders;
-- Найти сумму всех заказов
SELECT sum(total_amount)
FROM customer
         JOIN orders o on customer.id = o.customer_id;
-- Найти сумму всех заказов за 2014 год
SELECT sum(total_amount)
FROM orders
WHERE order_date BETWEEN date'2014-1-1' AND date'2014-12-31';
-- Найти среднюю стоимость всех заказов
SELECT avg(total_amount)
FROM orders;
-- Найти среднюю стоимость всех заказов по каждому клиенту
SELECT customer.first_name, avg(total_amount)
FROM customer
         JOIN orders o on customer.id = o.customer_id
GROUP BY customer.first_name;
-- Найти всех клиентов, которые живут в Бразилии или Испании
SELECT  * FROM customer WHERE country='Spain' or country='Brazil';
-- Найти все заказы между 2013ым и 2014ым годами, которые стоили меньше 100.00$
SELECT * FROM customer JOIN orders o on customer.id = o.customer_id
WHERE order_date BETWEEN date '2013-1-1' AND date'2014-12-31' and total_amount<100;
-- Найти всех клиентов, которые в одной из стран: Испания, Италия, Германия, Франция. Отсортируйте по странам
SELECT * FROM customer where country in ('Spain','Germany','France','Italy') ORDER BY country;
-- Найти все страны клиентов, страны которых содержаться в таблице поставщиков
SELECT  DISTINCT customer.country,first_name as customer_name,contact_name as supplier_name FROM  customer
    JOIN supplier s on customer.country = s.country order by customer.country;
-- Найти всех клиентов, имена которых начинаются на ‘Jo’
SELECT  * FROM customer where first_name like 'Jo%';
-- Найти всех клиентов, имена которых заканчиваются на ‘a’ и имеют длину ровно 4 символа
SELECT * FROM customer where first_name like  '___a';
-- Найти количество клиентов по странам
SELECT  country,count(customer.id) as quantity FROM customer
GROUP BY country ;
-- Найти количество клиентов по странам. Вывести в порядке убывания
SELECT   country,count(customer.id)as quantity FROM customer
GROUP BY country ORDER BY quantity desc;
-- Найти общую сумму стоимости заказов и количество заказов по каждому клиенту (customer_id). Отсортировать по сумме
SELECT customer.first_name,sum(o.total_amount) as sum_orders,count(o.id) as quantity_orders FROM customer
JOIN orders o on customer.id = o.customer_id
GROUP BY customer.first_name ORDER BY sum_orders;
-- Найти общую сумму стоимости заказов и количество заказов по каждому клиенту (customer_id), у которых общее количество заказов больше 20ти
SELECT customer.first_name,sum(o.total_amount) as sum_orders,count(o.id) as quantity_orders FROM customer
    JOIN orders o on customer.id = o.customer_id
GROUP BY customer.first_name HAVING count(o.id)>20 order by quantity_orders desc ;
-- Найти количество городов в каждой из стран клиентов
SELECT country,count( DISTINCT city) as number_of_cityes FROM customer group by country ORDER BY count(city) desc;
